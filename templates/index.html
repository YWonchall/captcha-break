<head>
  <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
</head>

<div>
	<label>图片地址</label>
	<div>
		<input type='hidden' id='img_url' />
		<input type='file' onchange="showImg()"  id='img_file'/>
    <img src='' alt='' id='img_id' style='width:500px'>
   
	</div>
  <div>{{result}}</div>
</div>

<script>
  // 处理js数据在html显示问题
  var result = '123'
  function upload(file) {
    let params = new FormData();
    params.append('file', file);
    console.log(params)
    return axios.post("/upload", params, {headers:{'Content-Type':'multipart/form-data'}})
  }

  function showImg(){
    
    var file = document.getElementById('img_file').files[0];
    console.log(file)
    upload(file).then(res => {
      console.log(res.data)
      result = res.data
    })
    .catch(error => {
      console.log(-1)
    })
    .finally(() => {
      this.loading = false;
    });    
    var re = new FileReader();
    re.readAsDataURL(file);
    re.onload = function(re){
      document.getElementById('img_id').src=re.target.result;
    }
    
  }
</script>


